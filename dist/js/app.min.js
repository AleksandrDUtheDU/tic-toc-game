(()=>{"use strict";var e,t;e=function(e){1==e?document.querySelector("body").classList.add("webp"):document.querySelector("body").classList.add("no-webp")},(t=new Image).onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",document.addEventListener("DOMContentLoaded",(function(){(()=>{const e=document.querySelector("#board"),t=document.querySelectorAll("[data-party]"),a=e=>Array.from({length:e},((e,t)=>t+1));let o=a(9),l=a(9),n=!1,r="circle",c="cross";for(let t=1;t<=9;t++){const a=document.createElement("div");a.classList.add("box"),a.dataset.num=t,e.append(a)}const s=document.querySelectorAll("[data-num]");t.forEach((e=>{e.addEventListener("click",(e=>{n||(t.forEach((e=>e.classList.remove("active"))),e.target.classList.add("active"),r=e.target.dataset.party)}))})),s.forEach((e=>{e.addEventListener("click",(e=>{n=!0,"box"==e.target.classList.value?(e.target.classList.add(r),o[e.target.dataset.num-1]=r,(e=>{if(l=o.filter((e=>Number.isInteger(e))),l.length>0){"cross"==r&&(c="circle");const t=parseInt(e),a=[[1,2,3],[4,5,6],[7,8,9],[1,4,7],[2,5,8],[3,6,9],[1,5,9],[3,5,7]],n=()=>{window.confirm("Хотите начать игру заново?")&&window.location.reload()},s=(e,t)=>t.filter((t=>e.includes(t))),i=e=>a.map((t=>t.filter((t=>o[t-1]==e)))).filter((e=>3==e.length)).flat(),d=e=>{const t=document.querySelector(`[data-num='${e}']`);o[e-1]=c,t.classList.add(c)},u=a.filter((e=>e.find((e=>e==t)))).map((e=>e.filter((e=>o[e-1]!==r&&o[e-1]!==c)))),g=e=>a.map((t=>t.filter((t=>o[t-1]!==e)))),f=e=>g(e).filter((e=>1==e.length)).flat(),m=s(l,f(r)),A=s(l,f(c)),h=u.filter((e=>e.find((e=>e%2!=0)))).flat();A.length>0?(d(A[0]),console.log("сработал крит AI")):m.length>0?(d(m[0]),console.log("сработал крит Play")):5==o[4]?(d(5),console.log("сработал 5")):h.length>0?(d(h[0]),console.log("сработал нечет")):l.length>0&&(d(l[0]),console.log("свободные")),3==i(r).length?setTimeout((function(){alert("Победил кожанный мешок!!"),n()}),1):3==i(c).length&&setTimeout((function(){alert("Победил скайнет!!"),n()}),1)}else 0==l.length&&setTimeout((function(){alert("НИЧЬЯ!!"),restartGame()}),1)})(e.target.dataset.num)):alert("ЗАНЯТО!!!")}))}))})()}))})();